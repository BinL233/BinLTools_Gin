{"ast":null,"code":"import React,{useState,userRef}from\"react\";import\"./login.css\";import Header from\"../../components/header/header.js\";import Footer from\"../../components/footer/footer.js\";import ErrorBox from\"../../components/errorBox/errorBox.js\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){const[user,setUser]=useState(\"\");const[pwd,setPwd]=useState(\"\");const[message,setMessage]=useState(\"\");const userRef=useRef(null);const pwdRef=useRef(null);const handleSubmit=async event=>{event.preventDefault();try{var _response$headers$get;const response=await fetch('/api/user/login_process',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:new URLSearchParams({'user':user,'pwd':pwd})});if((_response$headers$get=response.headers.get('content-type'))!==null&&_response$headers$get!==void 0&&_response$headers$get.includes('application/json')){const data=await response.json();if(response.ok){console.log(\"Login successful:\",data);setMessage(\"Login successful\");localStorage.setItem('token',data.token);window.location.href='/';}else{console.error(\"Login failed:\",data.msg);setMessage(data.msg||\"Login failed due to unknown error.\");error_notifier();}}else{const text=await response.text();console.error(\"Unexpected response format:\",text);setMessage(\"An error occurred. Please try again later.\");}}catch(error){console.error('Error during login:',error);setMessage(\"An error occurred. Please try again later.\");}function error_notifier(){switch(message){case\"Username cannot be null\":userRef.current.style.boxShadow='0 2px 10px 2px #f32f2f';case\"Username not exist\":userRef.current.style.boxShadow='0 2px 10px 2px #f32f2f';case\"Password cannot be null\":pwdRef.current.style.boxShadow='0 2px 10px 2px #f32f2f';case\"Incorrect password\":pwdRef.current.style.boxShadow='0 2px 10px 2px #f32f2f';}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Header,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"frame\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login_sub\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:\"Login\"}),/*#__PURE__*/_jsx(\"div\",{className:\"biao\",children:/*#__PURE__*/_jsxs(\"form\",{id:\"myForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{id:\"boxs\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"box1\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username: \"}),/*#__PURE__*/_jsx(\"label\",{children:\"Password: \"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"box2\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"username\",type:\"text\",name:\"user\",value:user,ref:userRef,onChange:e=>setUser(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:\"password\",name:\"pwd\",value:pwd,ref:pwdRef,onChange:e=>setPwd(e.target.value)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container2\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"button\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"button__line\"}),/*#__PURE__*/_jsx(\"div\",{className:\"button__line\"}),/*#__PURE__*/_jsx(\"span\",{className:\"button__text\",children:\"Login\"})]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/register\",id:\"go_to_register\",children:\"I don't have an account. I want to sign up!\"})})]})]})})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Footer,{})})]});}export default Login;","map":{"version":3,"names":["React","useState","userRef","Header","Footer","ErrorBox","jsx","_jsx","jsxs","_jsxs","Login","user","setUser","pwd","setPwd","message","setMessage","useRef","pwdRef","handleSubmit","event","preventDefault","_response$headers$get","response","fetch","method","headers","body","URLSearchParams","get","includes","data","json","ok","console","log","localStorage","setItem","token","window","location","href","error","msg","error_notifier","text","current","style","boxShadow","className","children","id","onSubmit","type","name","value","ref","onChange","e","target"],"sources":["/Users/kaileying/Documents/Repos/BinLTools_Gin/web/src/pages/login/login.js"],"sourcesContent":["import React, { useState, userRef } from \"react\";\nimport \"./login.css\";\nimport Header from \"../../components/header/header.js\";\nimport Footer from \"../../components/footer/footer.js\";\nimport ErrorBox from \"../../components/errorBox/errorBox.js\";\n\nfunction Login() {\n    const [user, setUser] = useState(\"\");\n    const [pwd, setPwd] = useState(\"\");\n    const [message, setMessage] = useState(\"\");\n    const userRef = useRef(null);\n    const pwdRef = useRef(null);\n\n    const handleSubmit = async (event) => {\n        event.preventDefault();\n\n        try {\n            const response = await fetch('/api/user/login_process', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                },\n                body: new URLSearchParams({\n                    'user': user,\n                    'pwd': pwd\n                })\n            });\n\n            if (response.headers.get('content-type')?.includes('application/json')) {\n                const data = await response.json();\n                if (response.ok) {\n                    console.log(\"Login successful:\", data);\n                    setMessage(\"Login successful\");\n                    localStorage.setItem('token', data.token);\n                    window.location.href = '/';\n                } else {\n                    console.error(\"Login failed:\", data.msg);\n                    setMessage(data.msg || \"Login failed due to unknown error.\");\n                    error_notifier();\n                }\n            } else {\n                const text = await response.text();\n                console.error(\"Unexpected response format:\", text);\n                setMessage(\"An error occurred. Please try again later.\");\n            }\n        } catch (error) {\n            console.error('Error during login:', error);\n            setMessage(\"An error occurred. Please try again later.\");\n        }\n\n        function error_notifier() {\n            switch (message) {\n                case \"Username cannot be null\":\n                    userRef.current.style.boxShadow = '0 2px 10px 2px #f32f2f';\n\n                case \"Username not exist\":\n                    userRef.current.style.boxShadow = '0 2px 10px 2px #f32f2f';\n\n                case \"Password cannot be null\":\n                    pwdRef.current.style.boxShadow = '0 2px 10px 2px #f32f2f';\n\n                case \"Incorrect password\":\n                    pwdRef.current.style.boxShadow = '0 2px 10px 2px #f32f2f';\n            }\n        }\n    };\n\n    return (\n        <div className=\"login\">\n            {/* Import Header */}\n            <div>\n                <Header />\n            </div>\n\n            <div className=\"frame\">\n                <div className='login_sub'>\n                    <div className='title'>Login</div>\n                    <div className='biao'>\n                        <form id=\"myForm\" onSubmit={handleSubmit}>\n                            <div id=\"boxs\">\n                                <div className=\"box1\">\n                                    <label>Username: </label>\n                                    <label>Password: </label>\n                                </div>\n                                <div className=\"box2\">\n                                    <input id=\"username\"\n                                        type=\"text\"\n                                        name=\"user\"\n                                        value={user}\n                                        ref={userRef}\n                                        onChange={(e) => setUser(e.target.value)}\n                                    />\n                                    <input id=\"password\"\n                                        type=\"password\"\n                                        name=\"pwd\"\n                                        value={pwd}\n                                        ref={pwdRef}\n                                        onChange={(e) => setPwd(e.target.value)}\n                                    />\n                                </div>\n                            </div>\n                            <div className=\"container2\">\n                                <button type=\"submit\" className=\"button\">\n                                    <div className=\"button__line\"></div>\n                                    <div className=\"button__line\"></div>\n                                    <span className=\"button__text\">Login</span>\n                                </button>\n                                <p><a href=\"/register\" id=\"go_to_register\">I don't have an account. I want to sign up!</a></p>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n            {/* Import Footer */}\n            <div>\n                <Footer />\n            </div>\n        </div>\n    );\n}\n\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}